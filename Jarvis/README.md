# Jarvis: Server Component

**Version:** 1.0.0
**Language:** Go (1.24+)

## Overview

This directory contains the source code for **Jarvis**, the Go-based MCP server that acts as the gateway between your AI Agent and the underlying system infrastructure.

While the [Root README](../README.md) covers high-level usage and tools, this document focuses on the internal development and structure of the Go application.

## üìÇ Directory Structure

*   **`main.go`**: The single-file entry point. It defines:
    *   **Tool Definitions:** The schema for every tool exposed to the agent (`install_server`, `bootstrap_system`, etc.).
    *   **Execution Logic:** The handlers that invoke the `mcpm` CLI via `exec.Command`.
    *   **MCP Server:** The server instance using `github.com/mark3labs/mcp-go`.
*   **`Dockerfile`**: Defines the container image for running Jarvis in a deployed environment (though local execution is preferred for tool management).

## üõ†Ô∏è Building from Source

### Prerequisites
*   Go 1.24 or higher
*   Make (optional, standard Go commands work fine)

### Compilation
Jarvis is built as a static binary.

```bash
go mod download
go build -o jarvis .
```

### Running Locally
You can run the binary directly to test the Stdio transport (though it will expect MCP JSON-RPC messages on stdin).

```bash
./jarvis
```

## üß© Key Implementation Details

### The `bootstrap_system` Tool
Located in `main.go`, this critical tool is responsible for self-initialization. It performs the following heuristic:
1.  Locates the project root by looking for the `MCPM/` directory.
2.  Runs `npm install` and `npm link` inside `MCPM/`.
3.  Runs `docker-compose up -d` in the root.

### Shared Servers (Tunneling)
Jarvis manages a map of running background processes for the `share_server` tool.
*   **Concurrency:** Uses `sync.Mutex` to safely manage the state of shared tunnels.
*   **Process Management:** Captures `stdout` to detect the public URL generated by `mcpm share`.

## üß™ Testing
Currently, tests are manual via the Agent. Future improvements will add unit tests for the tool handlers.