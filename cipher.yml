# Recommended cipher.yml — template created by assistant on 2025-11-13T03:49:45Z
# NOTE: Review/adjust secrets and server commands before use.
# LM routing policy update:
# - Cline now calls OpenRouter directly for all LM requests
# - Cipher remains the MCP server/aggregator for tools only
# - Do NOT route IDE/LM requests through Cipher

systemPrompt: "You are a helpful AI assistant with MCP tools."

mcpServers:
  routing-metadata:
    enabled: true
    type: stdio
    command: python3
    args: ["servers/routing-metadata-mcp.py"]
    env:
      OTEL_ENABLED: "false"
  httpie:
    enabled: false  # Disabled: running as standalone MCP until MetaMCP hub
    type: stdio
    command: python3
    args: ["servers/httpie-mcp.py"]
    timeout: 60
  schemathesis:
    enabled: false  # Disabled: running as standalone MCP until MetaMCP hub
    type: stdio
    command: python3
    args: ["servers/schemathesis-mcp.py"]
    timeout: 60
  filesystem:
    enabled: true
    type: stdio
    command: python3
    args: ["servers/custom-filesystem-mcp.py"]
  file-batch:
    enabled: true
    type: stdio
    command: python3
    args: ["servers/file-batch-mcp.py"]
  pytest:
    enabled: false  # Disabled: running as standalone MCP until MetaMCP hub
    type: stdio
    command: python3
    args: ["servers/pytest-mcp.py"]
    timeout: 60
  firecrawl:
    enabled: false  # Disabled - requires FIRECRAWL_API_KEY
    type: stdio
    command: npx
    args: ["-y", "firecrawl-mcp"]
    env:
      FIRECRAWL_API_KEY: "${FIRECRAWL_API_KEY:-}"
  brave-search:
    enabled: true
    type: stdio
    command: npx
    args: ["-y", "@brave/brave-search-mcp-server"]
    env:
      BRAVE_API_KEY: "${BRAVE_API_KEY:-}"
  code-index:
    enabled: false
    type: stdio
    command: python3
    args: ["servers/code-index-mcp.py"]
  memory-bank:
    enabled: false  # Disabled: direct IDE MCP until MetaMCP hub
    type: stdio
    command: python3
    args: ["servers/memory_bank_wrapper.py"]
    timeout: 60
  logs:
    enabled: false
    type: stdio
    command: python3
    args: ["servers/logs-mcp.py"]
  context7:
    enabled: false  # Streamable HTTP requires session handshake; keep disabled until supported
    type: streamable-http
    url: "https://mcp.context7.com/mcp"
    headers:
      Accept: "application/json, text/event-stream"
      MCP-Protocol-Version: "2024-11-05"
    timeout: 60
  morph-fast-apply:
    enabled: false  # Streamable HTTP; keep disabled until validated
    type: streamable-http
    url: "https://mcp.morph.ai/fast-apply"
    timeout: 60
  gpt-researcher:
    enabled: false  # Disabled: direct IDE MCP until MetaMCP hub
    type: stdio
    command: python3
    args: ["servers/gpt_researcher_bridge.py"]
    env:
      TAVILY_API_KEY: "${TAVILY_API_KEY:-}"
      OPENAI_API_KEY: "${OPENAI_API_KEY:-}"
    timeout: 60

env:
  MCP_SERVER_MODE: aggregator
  OPENAI_API_KEY: "${OPENAI_API_KEY:-}"
  PATH: "/usr/local/bin:/usr/bin:/bin:${PATH:-}"

notes:
  - "This file is a recommended template. Verify all commands, venv paths, and environment variables before starting the aggregator."
  - "If you want, I can parse this file and store a structured routing summary into memory (servers, timeouts, routing rules)."
  - "LM policy: Cline → OpenRouter direct; Cipher is MCP-only. Enable llm-inference only for non-IDE flows if explicitly required."
